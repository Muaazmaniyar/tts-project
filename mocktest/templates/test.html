{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mock Test</title>
  <link rel="stylesheet" href="{% static 'css/test.css' %}">
</head>
<body>
  <div class="container">

    <!-- Sidebar -->
    <aside class="sidebar">
      <img src="{% static 'images/technokraft-logo.png' %}" alt="Logo">
      <p><strong>Choose a Question</strong></p>
      <div class="question-grid">
        {% for q in questions %}
          <button type="button" onclick="showQuestion({{ forloop.counter0 }})">
            {{ forloop.counter }}
          </button>
        {% endfor %}
      </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
      <header class="header">
        <h1>Mock Test</h1>
        <p><strong>Time Left:</strong> <span id="timer">60:00</span></p>
      </header>

      <form method="POST">
        {% csrf_token %}

        {% for question in questions %}
        <div class="question-box" id="question-{{ forloop.counter0 }}" style="{% if not forloop.first %}display:none;{% endif %}">
          <h3>Question No. {{ forloop.counter }}</h3>
          <p>{{ question.question_text }}</p>

          <!-- Answer Box -->
          <div class="answer-box">
            <label><input type="radio" name="question_{{ question.id }}" value="{{ question.option1 }}"> {{ question.option1 }}</label><br>
            <label><input type="radio" name="question_{{ question.id }}" value="{{ question.option2 }}"> {{ question.option2 }}</label><br>
            <label><input type="radio" name="question_{{ question.id }}" value="{{ question.option3 }}"> {{ question.option3 }}</label><br>
            <label><input type="radio" name="question_{{ question.id }}" value="{{ question.option4 }}"> {{ question.option4 }}</label><br>
          </div>
        </div>
        {% endfor %}

        <!-- Action Buttons -->
        <div class="action-buttons">
          <button type="button" class="mark">Mark for Review & Next</button>
          <button type="button" class="clear" onclick="clearResponse()">Clear Response</button>
          <button type="button" class="save" onclick="nextQuestion()">Save & Next</button>
          <button type="submit" class="submit">Submit</button>
        </div>
      </form>
    </main>
  </div>

  <script src="{% static 'js/test.js' %}"></script>
  <script>
    let currentIndex = 0;
    const totalQuestions = {{ questions|length }};

    function showQuestion(index) {
      document.querySelectorAll('.question-box').forEach((box, i) => {
        box.style.display = i === index ? 'block' : 'none';
      });
      currentIndex = index;
    }

    function nextQuestion() {
      if (currentIndex < totalQuestions - 1) {
        showQuestion(currentIndex + 1);
      }
    }

    function clearResponse() {
      const radios = document.querySelectorAll(`#question-${currentIndex} input[type=radio]`);
      radios.forEach(r => r.checked = false);
    }
  </script>
</body>
</html>
